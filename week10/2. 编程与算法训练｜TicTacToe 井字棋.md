# 编程与算法训练 | TicTacToe / 井字棋

[toc]

## 编程训练 —— TicTacToe

这节课开始进入到编程环节。为大家安排了一组比较综合的练习。

很多时候大家将编程训练和算法训练混在一起，算法训练只要求输入输出，而编程训练需要我们的过程、代码结构、对语言的基础工具的运用上都有一定的要求，所以编程是一个更广泛的概念。

之前有个公开课教大家做一个黑白棋，但逻辑很复杂，所以换一个相对简单的训练——TicTacToe（井字棋）

写这个游戏的难度其实不高，但是要在不用高级的 AI 算法下写出一个完美的 AI 就比较困难了。

### 规则

![image-20200617203421285](assets/image-20200617203421285.png)

- 连成的直线一共有 8 种可能。

可以用什么数据结构来表示一下棋盘？

- 一维数组（最好的一种）
- 二位数组（最符合人类思维）
- Map 
- ...

 需要注意的是不同的数据结构会牵涉到之后的算法。

我们用一种数据结构来表示这个棋盘，实际上是要从一个坐标中拿到不同位置的状态。这个游戏中每一个点有三种状态：

1. 没有棋子
2. X 棋子
3. O 棋子

二维数组比较符合人类的思维，所以我们先用二位数组来完成这次练习，然后会再用一维数组来过一遍。所以叫编程练习，是因为不但要讲算法，还会涉及到用什么样的数据结构去抽象什么的问题。一维数组这个抽象是一个非常好，而且是非常强大的抽象，有什么好处呢，之后讲到的时候就知道了，比如百分号取余换行。

### 步骤

#### 第一步 —— 决定数据结构

```html
<script>
	let pattern = [
    [0,0,0],
    [0,0,0],
    [0,0,0]
  ]
</script>
```

将 pattern 表示为二位数组。



#### 第二步 —— 渲染 UI

渲染 UI

> 作业不限制使用 UI 的技术，不过需要注意的是，你所使用的技术是你能够驾驭的。

```js
const X = '❌';
const O = '⭕️';
let pattern = [
  [X, 0, 0],
  [0, O, 0],
  [0, 0, X],
];
let board = document.querySelector('.checkerboard');

function render() {
  pattern.forEach((row) => {
    row.forEach((str) => {
      let cell = document.createElement('div');
      cell.classList.add('cell');
      cell.innerHTML = str ? str : '';
      board.appendChild(cell);
    }); 
  });
}

render();
```



#### 第三步 —— 放置棋子

两个难点：

- 

技巧：

虽然这个技巧我的代码中没有使用到，但是可以记一下。

```js
let color = 1;

function move(x, y){
  pattern[y][x] = 1;
  color = 3 - color;
	// or
  color = 3 / color;
  // or
  color = color === 2 ? 1 : 2
  show();
}
```

- 当一个变量在两个数值状态之间切换的时候可以使用，两数之和减去变量，或者两数之积除以变量，当然也可以使用三元操作符。



#### 第四步 —— 判断胜负

我需要思考除了枚举八种胜利的情况然后 if else 之外是否还有其他的算法。

- 一种是参考落子点，然后看有没有新增的情况。
- 全屏检查

算法就这两种，你要考虑的问题是什么，什么是斜线、横向、纵向上全是一样棋子的情况。

先写三行三纵相同相同的情况。

我们应该先考虑如果设计判断胜负的函数其传入值和返回值都是什么？

- 在这个游戏中，我们可以传入的值有刚刚下的棋子的种类和棋子的位置以及棋盘。

  > 所以在考虑函数传什么的时候，也可以先考虑能传入的东西有哪些。



### 问答

- 绑定事件过多不是会影响性能吗？
  - 你们对性能的认识有根本性的错误，性能的好坏是实际测出来的，不是凭空或者看网上的文章去胡说的事情。
  - 另外，性能好性能差，for 循环 while 循环性能有差异，你选用哪个是看这个地方性能是否重要，其次才是性能好性能坏的问题。
  - 对绑定事件这个事情来说，无论是重要性还是好坏性都是否定的，首先这个地方的性能不重要，其次绑定过多的事件并不会影响性能，触发事件才会影响性能。



### 补充

- 如果在工作或者学习中做了好事要学会宣传和表达。

## 课程涉及内容

### 答疑回放：

- 链接：[ https://pan.baidu.com/s/1jC-SX7eK76HqVQyXbvthCA](https://pan.baidu.com/s/1jC-SX7eK76HqVQyXbvthCA)
  提取码：h0xm

### 参考代码：

```js
function show(){
  let board = document.getElementById("board");

  board.innerHTML = "";

  for(let i = 0; i < 3; i++){
    for(let j = 0; j < 3; j++){
      let cell = document.createElement("div");
      cell.classList.add("cell");
      cell.innerText = pattern[i][j] == 2 ? "❌" :
      pattern[i][j] == 1 ? "⭕️" : "";
      cell.addEventListener("click", () => move(j, i));
      board.appendChild(cell);
    }
    board.appendChild(document.createElement("br"))
  }
}
```

```css
.cell {
  width:100px;
  height:100px;
  background-color: green;
  display:inline-block;
  border:solid 1px white;
  vertical-align: middle;

  line-height: 100px;
  font-size: 50px;
  text-align: center;
}
```

### 参考名词：

- 蒙特卡罗方法（英语：Monte Carlo method），也称统计模拟方法，是 1940 年代中期由于科学技术的发展和电子计算机的发明，而提出的一种以概率统计理论为指导的数值计算方法。是指使用随机数（或更常见的伪随机数）来解决很多计算问题的方法。
  20 世纪 40 年代，在科学家冯·诺伊曼、斯塔尼斯拉夫·乌拉姆和尼古拉斯·梅特罗波利斯于洛斯阿拉莫斯国家实验室为核武器计划工作时，发明了蒙特卡罗方法。因为乌拉姆的叔叔经常在摩纳哥的蒙特卡洛赌场输钱得名，而蒙特卡罗方法正是以概率为基础的方法。（[ https://zh.wikipedia.org/wiki/ 蒙地卡羅方法](https://zh.wikipedia.org/wiki/蒙地卡羅方法) ）

### 课后作业：

- 看完课程，完成 TicTacToe 的练习
- 根据课程内容自己完成一个五子棋的游戏编程（选做）